<div id="content">
  <app-back-nav></app-back-nav>
  <div id="recipes-header">
    <h1>Добавить новый рецепт</h1>
    <button mat-flat-button color="accent" id="publish-recipe-button" type='submit' (click)="publish()">
      Опубликовать
    </button>
  </div>


  <form [formGroup]="recipeForm">
    <div id="primary-block">
      <div id="image-block" *ngIf="image == null; else imageUploaded">
        <button mat-button id="input-div-clickable-wrapper" (click)="fileUpload.click()">
          <input type="file" class="file-input" [accept]="acceptImageTypes" (change)="onFileSelected($event)" #fileUpload>
          <span id="input-div">
          <mat-icon id="upload-icon">cloud_download</mat-icon>
          <span id="upload-text">Загрузите фото готового блюда</span>
        </span>
        </button>
      </div>

      <ng-template #imageUploaded>
        <div id="uploaded-image-block">
          <img id="uploaded-image" [src]="image" alt="preview">
          <button mat-icon-button class="close-icon" (click)="deleteImage()">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      </ng-template>


      <div id="primary-recipe-info">
        <div class="input-block-with-margin">
          <mat-form-field class="wide-mat-form-field">
            <mat-label>Название рецепта</mat-label>
            <input required type="text" matInput formControlName="recipeName">
          </mat-form-field>
        </div>

        <div class="input-block-with-margin">
          <mat-form-field id="recipe-description">
            <mat-label>Краткое описание рецепта (150 символов)</mat-label>
            <textarea rows="5" matInput formControlName="recipeDescription"></textarea>
          </mat-form-field>
        </div>

        <div id="cooking-portions-line">
          <mat-form-field class="line-form-field">
            <mat-label>Время готовки</mat-label>
            <input type="number" matInput formControlName="cookingTime">
          </mat-form-field>
          <span>Минут</span>

          <mat-form-field id="second-mat-form-field" class="line-form-field">
            <mat-label>Порций в блюде</mat-label>
              <input type="number" matInput formControlName="portions">
          </mat-form-field>
          <span>Персон</span>
        </div>
      </div>
    </div>

    <div id="bottom-blocks">
      <div id="first-bottom-block">
        <h2>Ингредиенты</h2>
        <div formArrayName="ingredients" class="ingredient-block" *ngFor="let ingredient of ingredients.controls; let i = index">
          <mat-form-field class="wide-mat-form-field ingredient-header">
            <mat-label>Заголовок для ингредиентов</mat-label>
            <input type="text" matInput>
          </mat-form-field>

          <mat-form-field class="ingredient-value">
            <mat-label>Список продуктов для категории</mat-label>
            <textarea rows="8" matInput></textarea>
          </mat-form-field>

          <button mat-icon-button class="close-icon close-ingredient-icon" (click)="deleteIngredient(i)">
            <mat-icon>close</mat-icon>
          </button>
        </div>

        <button mat-stroked-button color="accent" class="add-item-button" (click)="addIngredient()" type='button'>
          Добавить заголовок
        </button>
      </div>
      <div id="second-bottom-block">
        <div formArrayName="steps" class="step" *ngFor="let step of steps.controls; let i = index">
          <h3 class="step-header">Шаг {{i+1}}</h3>
          <mat-form-field class="step-value">
            <mat-label>Описание шага</mat-label>
            <textarea rows="4" matInput></textarea>
          </mat-form-field>
          <button mat-icon-button class="close-icon close-step-icon" (click)="deleteStep(i)">
            <mat-icon>close</mat-icon>
          </button>
        </div>
        <div id="add-step-wrapper">
          <button mat-stroked-button color="accent" class="add-item-button" (click)="addStep()" type='button'>
            Добавить шаг
          </button>
        </div>

      </div>
    </div>
  </form>

</div>
